<!DOCTYPE html>
<html>
<head>
<title>PadiBuddy Smart</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#111;color:white;}
.hidden{display:none;}
.center{text-align:center;margin-top:100px;}
input,select{padding:8px;margin:5px;width:220px;}
button{padding:8px 15px;margin:5px;cursor:pointer;}
.sidebar{position:fixed;left:0;top:0;width:200px;height:100vh;background:#222;padding-top:20px;}
.sidebar button{display:block;width:90%;margin:10px auto;}
.main{margin-left:200px;padding:20px;}
.page{display:none;}
.active{display:block;}
.task{background:#333;margin:5px;padding:8px;display:flex;justify-content:space-between;}
.chatBox{background:#222;height:200px;overflow-y:auto;padding:10px;margin-bottom:10px;}
.user{color:#4ea1ff;text-align:right;}
.ai{color:#90ee90;text-align:left;}
table{width:100%;border-collapse:collapse;text-align:center;}
th,td{border:1px solid #444;padding:5px;}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginPage" class="center">
<h2>Login</h2>
<input id="loginUser" placeholder="Username"><br>
<input id="loginPass" type="password" placeholder="Password"><br>
<button onclick="loginFunc()">Login</button><br>
<button onclick="showRegister()">Go to Register</button>
</div>

<!-- REGISTER -->
<div id="registerPage" class="center hidden">
<h2>Register</h2>
<input id="regUser" placeholder="Username"><br>
<input id="regPass" type="password" placeholder="Password"><br>
<button onclick="registerFunc()">Register</button><br>
<button onclick="showLogin()">Go to Login</button>
</div>

<!-- APP -->
<div id="appPage" class="hidden">

<div class="sidebar">
<button onclick="openPage('dashboardPage')">Dashboard</button>
<button onclick="openPage('tasksPage')">Tasks</button>
<button onclick="openPage('schedulePage')">Schedule</button>
<button onclick="openPage('analyticsPage')">Analytics</button>
<button onclick="openPage('aiPage')">AI</button>
<button onclick="openPage('profilePage')">Profile</button>
<button onclick="logout()">Logout</button>
</div>

<div class="main">

<div id="dashboardPage" class="page active">
<h2 id="welcomeText"></h2>
<p>ðŸ”¥ Streak: <span id="streakText">0</span></p>
<button onclick="updateStreak()">Update Streak</button>
</div>

<div id="tasksPage" class="page">
<h3>Add Task</h3>
<input id="taskInput" placeholder="Task">
<button onclick="addTask()">Add</button>
<div id="taskList"></div>
</div>

<div id="schedulePage" class="page">
<h3>Auto Timetable Generator</h3>
<input id="subjectInput" placeholder="Enter subjects (comma separated)">
<select id="hoursSelect">
<option value="1">1 hour/day</option>
<option value="2">2 hours/day</option>
<option value="3">3 hours/day</option>
</select>
<button onclick="generateTimetable()">Generate</button>

<h3>Weekly Schedule</h3>
<table id="scheduleTable">
<tr><th>Day</th><th>Study Plan</th></tr>
<tr><td>Mon</td><td id="Mon"></td></tr>
<tr><td>Tue</td><td id="Tue"></td></tr>
<tr><td>Wed</td><td id="Wed"></td></tr>
<tr><td>Thu</td><td id="Thu"></td></tr>
<tr><td>Fri</td><td id="Fri"></td></tr>
</table>
</div>

<div id="analyticsPage" class="page">
<h3>Analytics</h3>
<p>Total Tasks: <span id="totalTasks"></span></p>
<p>Completed Tasks: <span id="completedTasks"></span></p>
<p>Completion Rate: <span id="completionRate"></span>%</p>
</div>

<div id="aiPage" class="page">
<h3>Smart AI Assistant</h3>
<div id="chatArea" class="chatBox"></div>
<input id="aiInput" placeholder="Ask something">
<button onclick="sendAI()">Send</button>
</div>

<div id="profilePage" class="page">
<h3>Profile</h3>
<p id="profileInfo"></p>
</div>

</div>
</div>

<script>
var currentUser=null;

/* AUTH */
function showRegister(){loginPage.classList.add("hidden");registerPage.classList.remove("hidden");}
function showLogin(){registerPage.classList.add("hidden");loginPage.classList.remove("hidden");}

function registerFunc(){
var u=regUser.value.trim();
var p=regPass.value.trim();
if(u===""||p===""){alert("Fill fields");return;}
var users=JSON.parse(localStorage.getItem("users"))||{};
if(users[u]){alert("User exists");return;}
users[u]={password:p,tasks:[],streak:0,lastDate:null,schedule:{}};
localStorage.setItem("users",JSON.stringify(users));
alert("Registered");showLogin();
}

function loginFunc(){
var u=loginUser.value.trim();
var p=loginPass.value.trim();
var users=JSON.parse(localStorage.getItem("users"))||{};
if(users[u]&&users[u].password===p){
currentUser=u;
loginPage.classList.add("hidden");
appPage.classList.remove("hidden");
loadUser();
}else alert("Invalid");
}

/* LOAD */
function loadUser(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
welcomeText.innerText="Welcome "+currentUser;
streakText.innerText=user.streak;
profileInfo.innerHTML="Username: "+currentUser+"<br>Streak: "+user.streak;
loadTasks();
loadAnalytics();
}

/* NAV */
function openPage(id){
var pages=document.getElementsByClassName("page");
for(var i=0;i<pages.length;i++)pages[i].classList.remove("active");
document.getElementById(id).classList.add("active");
}

/* TASKS */
function addTask(){
if(!currentUser)return;
var text=taskInput.value.trim();
if(text==="")return;
var users=JSON.parse(localStorage.getItem("users"));
users[currentUser].tasks.push({text:text,done:false});
localStorage.setItem("users",JSON.stringify(users));
taskInput.value="";
loadTasks();
}

function loadTasks(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
taskList.innerHTML="";
user.tasks.forEach(function(t,i){
var div=document.createElement("div");
div.className="task";
div.innerHTML="<span>"+t.text+"</span>";
var cb=document.createElement("input");
cb.type="checkbox";
cb.checked=t.done;
cb.onchange=function(){
user.tasks[i].done=this.checked;
localStorage.setItem("users",JSON.stringify(users));
loadAnalytics();
};
div.appendChild(cb);
taskList.appendChild(div);
});
}

/* STREAK */
function updateStreak(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var today=new Date().toDateString();
if(user.lastDate===today){alert("Already updated");return;}
user.streak++;user.lastDate=today;
localStorage.setItem("users",JSON.stringify(users));
streakText.innerText=user.streak;
}

/* ANALYTICS */
function loadAnalytics(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var total=user.tasks.length;
var completed=user.tasks.filter(t=>t.done).length;
totalTasks.innerText=total;
completedTasks.innerText=completed;
completionRate.innerText=total?Math.round((completed/total)*100):0;
}

/* AUTO TIMETABLE */
function generateTimetable(){
var subjects=subjectInput.value.split(",");
var hours=parseInt(hoursSelect.value);
if(subjects.length===0)return;
var days=["Mon","Tue","Wed","Thu","Fri"];
for(var i=0;i<days.length;i++){
var subject=subjects[i%subjects.length].trim();
document.getElementById(days[i]).innerText=
subject+" - "+hours+" hour(s)";
}
}

/* SMART AI */
function sendAI(){
var input=aiInput.value.trim();
if(input==="")return;
chatArea.innerHTML+="<div class='user'>"+input+"</div>";
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var response="Stay consistent!";
if(input.toLowerCase().includes("plan"))
response="You have "+user.tasks.length+" tasks.";
if(input.toLowerCase().includes("timetable"))
response="Use the schedule generator to balance subjects.";
chatArea.innerHTML+="<div class='ai'>"+response+"</div>";
aiInput.value="";
chatArea.scrollTop=chatArea.scrollHeight;
}

/* LOGOUT */
function logout(){location.reload();}
</script>

</body>
</html>
