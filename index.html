<!DOCTYPE html>
<html>
<head>
<title>PadiBuddy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:Arial; background:#121212; color:white; }
.hidden { display:none; }
.center { display:flex; justify-content:center; align-items:center; height:100vh; }
.card { background:#1f1f1f; padding:25px; border-radius:8px; width:300px; text-align:center; }
input { width:100%; padding:8px; margin:6px 0; border:none; border-radius:5px; background:#2a2a2a; color:white; }
button { padding:8px 15px; border:none; border-radius:5px; background:#4e9eff; color:white; cursor:pointer; margin-top:5px; }
.sidebar { width:220px; background:#1e1e1e; height:100vh; position:fixed; padding-top:20px; }
.sidebar h2 { text-align:center; color:#4e9eff; }
.sidebar button { display:block; width:90%; margin:10px auto; background:#2a2a2a; text-align:left; }
.sidebar button:hover { background:#4e9eff; }
.main { margin-left:220px; padding:20px; }
.page { display:none; }
.active { display:block; }
.task { background:#2a2a2a; padding:8px; margin:6px 0; border-radius:5px; display:flex; justify-content:space-between; }
.progress { background:#2a2a2a; height:15px; border-radius:10px; margin-top:10px; }
.progress-bar { height:100%; background:#4e9eff; width:0%; border-radius:10px; }
.chat { background:#2a2a2a; height:200px; overflow-y:auto; padding:10px; border-radius:5px; margin-bottom:10px; }
.user { text-align:right; color:#4e9eff; }
.ai { text-align:left; color:#90ee90; }
table { width:100%; border-collapse:collapse; text-align:center; }
th,td { border:1px solid #333; padding:5px; }
td { cursor:text; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox" class="center">
<div class="card">
<h2>Login</h2>
<input id="loginUser" placeholder="Username">
<input id="loginPass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="showRegister()">Go to Register</button>
</div>
</div>

<!-- REGISTER -->
<div id="registerBox" class="center hidden">
<div class="card">
<h2>Register</h2>
<input id="regUser" placeholder="Username">
<input id="regPass" type="password" placeholder="Password">
<button onclick="register()">Register</button>
<button onclick="showLogin()">Go to Login</button>
</div>
</div>

<!-- APP -->
<div id="app" class="hidden">
<div class="sidebar">
<h2>PadiBuddy</h2>
<button onclick="openPage('dashboard')">Dashboard</button>
<button onclick="openPage('tasks')">Tasks</button>
<button onclick="openPage('schedule')">Schedule</button>
<button onclick="openPage('analytics')">Analytics</button>
<button onclick="openPage('ai')">AI</button>
<button onclick="openPage('profile')">Profile</button>
<button onclick="logout()">Logout</button>
</div>

<div class="main">

<!-- DASHBOARD -->
<div id="dashboard" class="page active">
<h2 id="welcome"></h2>
<p>ðŸ”¥ Streak: <span id="streak">0</span> days</p>
<button onclick="updateStreak()">Update Streak</button>
</div>

<!-- TASKS -->
<div id="tasks" class="page">
<input id="taskInput" placeholder="Task">
<input type="date" id="deadlineInput">
<button onclick="addTask()">Add Task</button>
<div class="progress"><div id="progressBar" class="progress-bar"></div></div>
<div id="taskList"></div>
</div>

<!-- SCHEDULE -->
<div id="schedule" class="page">
<h3>Weekly Grid</h3>
<table id="grid">
<tr><th>Time</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th></tr>
<tr><td>6-8</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
<tr><td>8-10</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
</table>
<button onclick="saveGrid()">Save Schedule</button>
</div>

<!-- ANALYTICS -->
<div id="analytics" class="page">
<p>Total Tasks: <span id="totalTasks"></span></p>
<p>Completed: <span id="completedTasks"></span></p>
<p>Completion Rate: <span id="completionRate"></span>%</p>
</div>

<!-- AI -->
<div id="ai" class="page">
<div id="chatBox" class="chat"></div>
<input id="aiInput" placeholder="Ask something">
<button onclick="sendAI()">Send</button>
</div>

<!-- PROFILE -->
<div id="profile" class="page">
<p id="profileInfo"></p>
</div>

</div>
</div>

<script>
let currentUser=null;

/* PAGE SWITCH */
function showRegister(){ loginBox.classList.add("hidden"); registerBox.classList.remove("hidden"); }
function showLogin(){ registerBox.classList.add("hidden"); loginBox.classList.remove("hidden"); }

/* REGISTER */
function register(){
let username=regUser.value.trim();
let password=regPass.value.trim();
if(username===""||password===""){ alert("Fill all fields"); return; }
let users=JSON.parse(localStorage.getItem("users"))||{};
if(users[username]){ alert("User exists"); return; }
users[username]={ password:password, tasks:[], streak:0, lastDate:null, grid:[] };
localStorage.setItem("users",JSON.stringify(users));
alert("Registered successfully");
showLogin();
}

/* LOGIN */
function login(){
let username=loginUser.value.trim();
let password=loginPass.value.trim();
let users=JSON.parse(localStorage.getItem("users"))||{};
if(users[username] && users[username].password===password){
currentUser=username;
loginBox.classList.add("hidden");
app.classList.remove("hidden");
loadUser();
}else{ alert("Invalid login"); }
}

/* LOAD USER */
function loadUser(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
welcome.innerText="Welcome "+currentUser;
streak.innerText=user.streak;
profileInfo.innerHTML="Username: "+currentUser+"<br>Streak: "+user.streak;
loadTasks();
loadAnalytics();
loadGrid();
}

/* NAVIGATION */
function openPage(id){
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

/* TASKS */
function addTask(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
if(taskInput.value==="") return;
user.tasks.push({ text:taskInput.value, deadline:deadlineInput.value, done:false });
localStorage.setItem("users",JSON.stringify(users));
taskInput.value=""; deadlineInput.value="";
loadTasks();
}
function loadTasks(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
taskList.innerHTML="";
let done=0;
user.tasks.forEach((t,i)=>{
let div=document.createElement("div");
div.className="task";
div.innerHTML="<span>"+t.text+" ("+t.deadline+")</span>";
let check=document.createElement("input");
check.type="checkbox";
check.checked=t.done;
check.onchange=function(){
user.tasks[i].done=this.checked;
localStorage.setItem("users",JSON.stringify(users));
loadTasks();
};
div.appendChild(check);
taskList.appendChild(div);
if(t.done) done++;
});
let percent=user.tasks.length?(done/user.tasks.length)*100:0;
progressBar.style.width=percent+"%";
loadAnalytics();
}

/* STREAK */
function updateStreak(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
let today=new Date().toDateString();
if(user.lastDate===today){ alert("Already updated today"); return; }
user.streak++; user.lastDate=today;
localStorage.setItem("users",JSON.stringify(users));
streak.innerText=user.streak;
}

/* ANALYTICS */
function loadAnalytics(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
totalTasks.innerText=user.tasks.length;
let completed=user.tasks.filter(t=>t.done).length;
completedTasks.innerText=completed;
completionRate.innerText=user.tasks.length?Math.round((completed/user.tasks.length)*100):0;
}

/* SCHEDULE */
function saveGrid(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
let cells=document.querySelectorAll("#grid td[contenteditable]");
let data=[];
cells.forEach(c=>data.push(c.innerText));
user.grid=data;
localStorage.setItem("users",JSON.stringify(users));
alert("Schedule saved");
}
function loadGrid(){
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
if(user.grid.length){
let cells=document.querySelectorAll("#grid td[contenteditable]");
cells.forEach((c,i)=>c.innerText=user.grid[i]||"");
}
}

/* AI */
function sendAI(){
if(aiInput.value==="") return;
chatBox.innerHTML+="<div class='user'>"+aiInput.value+"</div>";
let users=JSON.parse(localStorage.getItem("users"));
let user=users[currentUser];
let response="Stay consistent!";
if(aiInput.value.includes("plan")) response="You have "+user.tasks.length+" tasks pending.";
if(aiInput.value.includes("progress")) response="You completed "+user.tasks.filter(t=>t.done).length+" tasks.";
chatBox.innerHTML+="<div class='ai'>"+response+"</div>";
aiInput.value="";
chatBox.scrollTop=chatBox.scrollHeight;
}

/* LOGOUT */
function logout(){ location.reload(); }

</script>
</body>
</html>
