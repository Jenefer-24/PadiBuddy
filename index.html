<!DOCTYPE html>
<html>
<head>
<title>PadiBuddy Complete</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#111;color:white;}
.hidden{display:none;}
.container{margin-top:100px;text-align:center;}
input{padding:8px;margin:5px;width:220px;}
button{padding:8px 15px;margin:5px;cursor:pointer;}
.sidebar{position:fixed;left:0;top:0;width:200px;height:100vh;background:#222;padding-top:20px;}
.sidebar button{display:block;width:90%;margin:10px auto;}
.main{margin-left:200px;padding:20px;}
.page{display:none;}
.active{display:block;}
.task{background:#333;margin:5px;padding:8px;display:flex;justify-content:space-between;}
.chatBox{background:#222;height:200px;overflow-y:auto;padding:10px;margin-bottom:10px;}
.user{color:#4ea1ff;text-align:right;}
.ai{color:#90ee90;text-align:left;}
table{width:100%;border-collapse:collapse;text-align:center;}
th,td{border:1px solid #444;padding:5px;}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginPage" class="container">
<h2>Login</h2>
<input id="loginUser" placeholder="Username"><br>
<input id="loginPass" type="password" placeholder="Password"><br>
<button onclick="loginFunc()">Login</button><br>
<button onclick="showRegister()">Go to Register</button>
</div>

<!-- REGISTER -->
<div id="registerPage" class="container hidden">
<h2>Register</h2>
<input id="regUser" placeholder="Username"><br>
<input id="regPass" type="password" placeholder="Password"><br>
<button onclick="registerFunc()">Register</button><br>
<button onclick="showLogin()">Go to Login</button>
</div>

<!-- APP -->
<div id="appPage" class="hidden">

<div class="sidebar">
<button onclick="openPage('dashboardPage')">Dashboard</button>
<button onclick="openPage('tasksPage')">Tasks</button>
<button onclick="openPage('schedulePage')">Schedule</button>
<button onclick="openPage('analyticsPage')">Analytics</button>
<button onclick="openPage('aiPage')">AI</button>
<button onclick="openPage('profilePage')">Profile</button>
<button onclick="logout()">Logout</button>
</div>

<div class="main">

<div id="dashboardPage" class="page active">
<h2 id="welcomeText"></h2>
<p>ðŸ”¥ Streak: <span id="streakText">0</span></p>
<button onclick="updateStreak()">Update Streak</button>
</div>

<div id="tasksPage" class="page">
<h3>Add Task</h3>
<input id="taskInput" placeholder="Task">
<button onclick="addTask()">Add</button>
<div id="taskList"></div>
</div>

<div id="schedulePage" class="page">
<h3>Weekly Schedule</h3>
<table id="scheduleTable">
<tr><th>Time</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th></tr>
<tr><td>6-8</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
<tr><td>8-10</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
</table>
<button onclick="saveSchedule()">Save Schedule</button>
</div>

<div id="analyticsPage" class="page">
<h3>Analytics</h3>
<p>Total Tasks: <span id="totalTasks"></span></p>
<p>Completed Tasks: <span id="completedTasks"></span></p>
<p>Completion Rate: <span id="completionRate"></span>%</p>
</div>

<div id="aiPage" class="page">
<h3>AI Assistant</h3>
<div id="chatArea" class="chatBox"></div>
<input id="aiInput" placeholder="Ask something">
<button onclick="sendAI()">Send</button>
</div>

<div id="profilePage" class="page">
<h3>Profile</h3>
<p id="profileInfo"></p>
</div>

</div>
</div>

<script>

var currentUser = null;

/* Page Switch */
function showRegister(){
document.getElementById("loginPage").classList.add("hidden");
document.getElementById("registerPage").classList.remove("hidden");
}
function showLogin(){
document.getElementById("registerPage").classList.add("hidden");
document.getElementById("loginPage").classList.remove("hidden");
}

/* Register */
function registerFunc(){
var username=document.getElementById("regUser").value.trim();
var password=document.getElementById("regPass").value.trim();

if(username===""||password===""){alert("Fill all fields");return;}

var users=localStorage.getItem("users");
users=users?JSON.parse(users):{};

if(users[username]){alert("User exists");return;}

users[username]={password:password,tasks:[],streak:0,lastDate:null,schedule:[]};

localStorage.setItem("users",JSON.stringify(users));
alert("Registered successfully");
showLogin();
}

/* Login */
function loginFunc(){
var username=document.getElementById("loginUser").value.trim();
var password=document.getElementById("loginPass").value.trim();

var users=localStorage.getItem("users");
if(!users){alert("No users found");return;}
users=JSON.parse(users);

if(users[username]&&users[username].password===password){
currentUser=username;
document.getElementById("loginPage").classList.add("hidden");
document.getElementById("appPage").classList.remove("hidden");
loadUserData();
}else{alert("Invalid credentials");}
}

/* Load User */
function loadUserData(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];

document.getElementById("welcomeText").innerText="Welcome "+currentUser;
document.getElementById("streakText").innerText=user.streak;
document.getElementById("profileInfo").innerHTML=
"Username: "+currentUser+"<br>Streak: "+user.streak;

loadTasks();
loadAnalytics();
loadSchedule();
}

/* Navigation */
function openPage(id){
var pages=document.getElementsByClassName("page");
for(var i=0;i<pages.length;i++){pages[i].classList.remove("active");}
document.getElementById(id).classList.add("active");
}

/* Tasks */
function addTask(){
var text=document.getElementById("taskInput").value.trim();
if(text==="")return;

var users=JSON.parse(localStorage.getItem("users"));
users[currentUser].tasks.push({text:text,done:false});
localStorage.setItem("users",JSON.stringify(users));
document.getElementById("taskInput").value="";
loadTasks();
}

function loadTasks(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var list=document.getElementById("taskList");
list.innerHTML="";

user.tasks.forEach(function(task,index){
var div=document.createElement("div");
div.className="task";
var span=document.createElement("span");
span.innerText=task.text;

var checkbox=document.createElement("input");
checkbox.type="checkbox";
checkbox.checked=task.done;
checkbox.onchange=function(){
user.tasks[index].done=this.checked;
localStorage.setItem("users",JSON.stringify(users));
loadAnalytics();
};

div.appendChild(span);
div.appendChild(checkbox);
list.appendChild(div);
});
}

/* Streak */
function updateStreak(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var today=new Date().toDateString();
if(user.lastDate===today){alert("Already updated today");return;}
user.streak++;
user.lastDate=today;
localStorage.setItem("users",JSON.stringify(users));
document.getElementById("streakText").innerText=user.streak;
}

/* Analytics */
function loadAnalytics(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var total=user.tasks.length;
var completed=user.tasks.filter(t=>t.done).length;
document.getElementById("totalTasks").innerText=total;
document.getElementById("completedTasks").innerText=completed;
document.getElementById("completionRate").innerText=
total?Math.round((completed/total)*100):0;
}

/* Schedule */
function saveSchedule(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var cells=document.querySelectorAll("#scheduleTable td[contenteditable]");
var data=[];
cells.forEach(function(cell){data.push(cell.innerText);});
user.schedule=data;
localStorage.setItem("users",JSON.stringify(users));
alert("Schedule saved");
}

function loadSchedule(){
var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
if(user.schedule && user.schedule.length){
var cells=document.querySelectorAll("#scheduleTable td[contenteditable]");
cells.forEach(function(cell,i){
cell.innerText=user.schedule[i]||"";
});
}
}

/* AI */
function sendAI(){
var input=document.getElementById("aiInput").value.trim();
if(input==="")return;

var chat=document.getElementById("chatArea");
chat.innerHTML+="<div class='user'>"+input+"</div>";

var users=JSON.parse(localStorage.getItem("users"));
var user=users[currentUser];
var response="Stay consistent!";

if(input.toLowerCase().includes("plan"))
response="You have "+user.tasks.length+" tasks.";
if(input.toLowerCase().includes("progress"))
response="You completed "+user.tasks.filter(t=>t.done).length+" tasks.";

chat.innerHTML+="<div class='ai'>"+response+"</div>";
document.getElementById("aiInput").value="";
chat.scrollTop=chat.scrollHeight;
}

/* Logout */
function logout(){location.reload();}

</script>
</body>
</html>
