<!DOCTYPE html>
<html>
<head>
<title>PadiBuddy Stable</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#111;color:white;text-align:center;}
.hidden{display:none;}
.container{margin-top:100px;}
input{padding:8px;margin:5px;width:200px;}
button{padding:8px 15px;margin:5px;}
.sidebar{position:fixed;left:0;top:0;width:200px;height:100vh;background:#222;padding-top:20px;}
.sidebar button{display:block;width:90%;margin:10px auto;}
.main{margin-left:200px;padding:20px;}
.task{background:#333;margin:5px;padding:5px;display:flex;justify-content:space-between;}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginPage" class="container">
<h2>Login</h2>
<input id="loginUser" placeholder="Username"><br>
<input id="loginPass" type="password" placeholder="Password"><br>
<button onclick="loginUserFunc()">Login</button><br>
<button onclick="showRegister()">Go to Register</button>
</div>

<!-- REGISTER -->
<div id="registerPage" class="container hidden">
<h2>Register</h2>
<input id="registerUser" placeholder="Username"><br>
<input id="registerPass" type="password" placeholder="Password"><br>
<button onclick="registerUserFunc()">Register</button><br>
<button onclick="showLogin()">Go to Login</button>
</div>

<!-- APP -->
<div id="appPage" class="hidden">
<div class="sidebar">
<button onclick="showDashboard()">Dashboard</button>
<button onclick="showTasks()">Tasks</button>
<button onclick="logout()">Logout</button>
</div>

<div class="main">

<div id="dashboardPage">
<h2 id="welcomeText"></h2>
<p>ðŸ”¥ Streak: <span id="streakCount">0</span></p>
<button onclick="updateStreak()">Update Streak</button>
</div>

<div id="tasksPage" class="hidden">
<h3>Add Task</h3>
<input id="taskInput" placeholder="Task">
<button onclick="addTask()">Add</button>
<div id="taskList"></div>
</div>

</div>
</div>

<script>

var currentUser = null;

/* PAGE SWITCH */
function showRegister(){
document.getElementById("loginPage").classList.add("hidden");
document.getElementById("registerPage").classList.remove("hidden");
}

function showLogin(){
document.getElementById("registerPage").classList.add("hidden");
document.getElementById("loginPage").classList.remove("hidden");
}

/* REGISTER */
function registerUserFunc(){
var username = document.getElementById("registerUser").value.trim();
var password = document.getElementById("registerPass").value.trim();

if(username === "" || password === ""){
alert("Fill all fields");
return;
}

var users = localStorage.getItem("users");
if(users){
users = JSON.parse(users);
}else{
users = {};
}

if(users[username]){
alert("User already exists");
return;
}

users[username] = {
password: password,
tasks: [],
streak: 0,
lastDate: null
};

localStorage.setItem("users", JSON.stringify(users));

alert("Registered successfully");
showLogin();
}

/* LOGIN */
function loginUserFunc(){
var username = document.getElementById("loginUser").value.trim();
var password = document.getElementById("loginPass").value.trim();

var users = localStorage.getItem("users");
if(!users){
alert("No users registered");
return;
}

users = JSON.parse(users);

if(users[username] && users[username].password === password){
currentUser = username;
document.getElementById("loginPage").classList.add("hidden");
document.getElementById("appPage").classList.remove("hidden");
loadUserData();
}else{
alert("Invalid credentials");
}
}

/* LOAD USER */
function loadUserData(){
var users = JSON.parse(localStorage.getItem("users"));
var user = users[currentUser];

document.getElementById("welcomeText").innerText = "Welcome " + currentUser;
document.getElementById("streakCount").innerText = user.streak;

loadTasks();
}

/* LOGOUT */
function logout(){
location.reload();
}

/* NAVIGATION */
function showDashboard(){
document.getElementById("dashboardPage").classList.remove("hidden");
document.getElementById("tasksPage").classList.add("hidden");
}

function showTasks(){
document.getElementById("dashboardPage").classList.add("hidden");
document.getElementById("tasksPage").classList.remove("hidden");
}

/* TASKS */
function addTask(){
var taskText = document.getElementById("taskInput").value.trim();
if(taskText === "") return;

var users = JSON.parse(localStorage.getItem("users"));
users[currentUser].tasks.push({text:taskText, done:false});
localStorage.setItem("users", JSON.stringify(users));

document.getElementById("taskInput").value = "";
loadTasks();
}

function loadTasks(){
var users = JSON.parse(localStorage.getItem("users"));
var user = users[currentUser];
var list = document.getElementById("taskList");
list.innerHTML = "";

user.tasks.forEach(function(task, index){
var div = document.createElement("div");
div.className = "task";

var span = document.createElement("span");
span.innerText = task.text;

var checkbox = document.createElement("input");
checkbox.type = "checkbox";
checkbox.checked = task.done;

checkbox.onchange = function(){
user.tasks[index].done = this.checked;
localStorage.setItem("users", JSON.stringify(users));
};

div.appendChild(span);
div.appendChild(checkbox);
list.appendChild(div);
});
}

/* STREAK */
function updateStreak(){
var users = JSON.parse(localStorage.getItem("users"));
var user = users[currentUser];
var today = new Date().toDateString();

if(user.lastDate === today){
alert("Already updated today");
return;
}

user.streak++;
user.lastDate = today;
localStorage.setItem("users", JSON.stringify(users));
document.getElementById("streakCount").innerText = user.streak;
}

</script>

</body>
</html>
